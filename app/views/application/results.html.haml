#sky_search
  #container.socialContainer
    - sentence_singular = "résultat trouvé dans "
    - sentence_plural = "résultats trouvés dans "
   
    %h1#search_result
      Résultats pour
      = '"' << params[:search] << '"'

    #search_content
      .category.left
        %h4 
          = @projects.count 
          -if @projects.count > 1
            = sentence_plural
          -else 
            = sentence_singular
          %span.grey Projets
        -if !@projects.blank?
          -for project in @projects
            .clear
              %a{:href => project_path(project)}
                = image_tag project.avatar_project.url(:medium), :alt => project.name, :class => "left"
              %h3
                = project.name
              %p
                = truncate(project.description, :length => 200, :omission => '...')
        .clear

      .category.right
        %h4 
          = @users.count 
          -if @users.count > 1
            = sentence_plural
          -else 
            = sentence_singular
          %span.grey Utilisateurs
        -if !@users.blank?
          -for user in @users
            .clear
              -if user.url_img != nil
                %a{:href => user_path(user)}
                  = image_tag user.url_img << "=medium", :alt => user.login, :class => "left"
              -else
                %a{:href => user_path(user)}
                  = image_tag user.avatar.url(:medium), :class => "left"
              %h3
                = user.login
              -for job in user.jobs.where("project_id IS NULL")
                %span.tags
                  = "#" << job.label
      .clear

      #announces
        %h4 
          = @announces.count 
          -if @announces.count > 1
            = sentence_plural
          -else 
            = sentence_singular
          %span.grey Annonces
        - if !@announces.blank?
          - for announce in @announces
            .announce
              %div.left
                - if announce.author_type == 0
                  - @user = User.find(announce.author_id)
                  - if @user.url_img 
                    %a{:href => user_path(@user)}
                      %img{ :src => @user.url_img << "=medium", :alt => @user.login}
                  - else
                    %a{:href => user_path(@user)}
                      %img{ :src => @user.avatar.url(:medium), :alt => @user.login}
                - else
                  - @project = Project.find(announce.author_id)
                  %a{:href => project_path(@project)}
                    = image_tag @project.avatar_project.url(:medium), :class => "left"
          
              %div.left
                %p.send_mail
                  %img{:src => "#", :alt => ""}
                    = link_to "Postuler", :action => "postuler", :id => announce.author_id, :annouce_id => announce.id
                %h3
                  = announce.title
                - job = Job.find(announce.job_id)
                %p
                  %span 
                    = "#" << job.label
                %p
                  %img{:src => "/img/icons/location.png", :alt => ""}
                  %span 
                    = announce.location
                %p.description
                  = announce.description
              .clear
            .clear

      .push

